(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();const Ge=(e,r)=>e===r,oe={equals:Ge};let Me=Oe;const D=1,ie=2,Ce={owned:null,cleanups:null,context:null,owner:null};var N=null;let ge=null,S=null,A=null,B=null,ce=0;function Ue(e,r){const t=S,n=N,o=e.length===0,i=o?Ce:{owned:null,cleanups:null,context:null,owner:r===void 0?n:r},c=o?e:()=>e(()=>fe(()=>pe(i)));N=i,S=null;try{return te(c,!0)}finally{S=t,N=n}}function se(e,r){r=r?Object.assign({},oe,r):oe;const t={value:e,observers:null,observerSlots:null,comparator:r.equals||void 0},n=o=>(typeof o=="function"&&(o=o(t.value)),_e(t,o));return[Ae.bind(t),n]}function ee(e,r,t){const n=Pe(e,r,!1,D);ue(n)}function Be(e,r,t){t=t?Object.assign({},oe,t):oe;const n=Pe(e,r,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=t.equals||void 0,ue(n),Ae.bind(n)}function fe(e){if(S===null)return e();const r=S;S=null;try{return e()}finally{S=r}}function Ae(){if(this.sources&&this.state)if(this.state===D)ue(this);else{const e=A;A=null,te(()=>le(this),!1),A=e}if(S){const e=this.observers?this.observers.length:0;S.sources?(S.sources.push(this),S.sourceSlots.push(e)):(S.sources=[this],S.sourceSlots=[e]),this.observers?(this.observers.push(S),this.observerSlots.push(S.sources.length-1)):(this.observers=[S],this.observerSlots=[S.sources.length-1])}return this.value}function _e(e,r,t){let n=e.value;return(!e.comparator||!e.comparator(n,r))&&(e.value=r,e.observers&&e.observers.length&&te(()=>{for(let o=0;o<e.observers.length;o+=1){const i=e.observers[o],c=ge&&ge.running;c&&ge.disposed.has(i),(c?!i.tState:!i.state)&&(i.pure?A.push(i):B.push(i),i.observers&&Te(i)),c||(i.state=D)}if(A.length>1e6)throw A=[],new Error},!1)),r}function ue(e){if(!e.fn)return;pe(e);const r=N,t=S,n=ce;S=N=e,De(e,e.value,n),S=t,N=r}function De(e,r,t){let n;try{n=e.fn(r)}catch(o){return e.pure&&(e.state=D,e.owned&&e.owned.forEach(pe),e.owned=null),e.updatedAt=t+1,Ne(o)}(!e.updatedAt||e.updatedAt<=t)&&(e.updatedAt!=null&&"observers"in e?_e(e,n):e.value=n,e.updatedAt=t)}function Pe(e,r,t,n=D,o){const i={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:r,owner:N,context:null,pure:t};return N===null||N!==Ce&&(N.owned?N.owned.push(i):N.owned=[i]),i}function je(e){if(e.state===0)return;if(e.state===ie)return le(e);if(e.suspense&&fe(e.suspense.inFallback))return e.suspense.effects.push(e);const r=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<ce);)e.state&&r.push(e);for(let t=r.length-1;t>=0;t--)if(e=r[t],e.state===D)ue(e);else if(e.state===ie){const n=A;A=null,te(()=>le(e,r[0]),!1),A=n}}function te(e,r){if(A)return e();let t=!1;r||(A=[]),B?t=!0:B=[],ce++;try{const n=e();return Ie(t),n}catch(n){t||(B=null),A=null,Ne(n)}}function Ie(e){if(A&&(Oe(A),A=null),e)return;const r=B;B=null,r.length&&te(()=>Me(r),!1)}function Oe(e){for(let r=0;r<e.length;r++)je(e[r])}function le(e,r){e.state=0;for(let t=0;t<e.sources.length;t+=1){const n=e.sources[t];if(n.sources){const o=n.state;o===D?n!==r&&(!n.updatedAt||n.updatedAt<ce)&&je(n):o===ie&&le(n,r)}}}function Te(e){for(let r=0;r<e.observers.length;r+=1){const t=e.observers[r];t.state||(t.state=ie,t.pure?A.push(t):B.push(t),t.observers&&Te(t))}}function pe(e){let r;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),o=t.observers;if(o&&o.length){const i=o.pop(),c=t.observerSlots.pop();n<o.length&&(i.sourceSlots[c]=n,o[n]=i,t.observerSlots[n]=c)}}if(e.owned){for(r=e.owned.length-1;r>=0;r--)pe(e.owned[r]);e.owned=null}if(e.cleanups){for(r=e.cleanups.length-1;r>=0;r--)e.cleanups[r]();e.cleanups=null}e.state=0,e.context=null}function Ne(e){throw e}function ve(e,r){return fe(()=>e(r||{}))}function We(e,r,t){let n=t.length,o=r.length,i=n,c=0,a=0,p=r[o-1].nextSibling,g=null;for(;c<o||a<i;){if(r[c]===t[a]){c++,a++;continue}for(;r[o-1]===t[i-1];)o--,i--;if(o===c){const v=i<n?a?t[a-1].nextSibling:t[i-a]:p;for(;a<i;)e.insertBefore(t[a++],v)}else if(i===a)for(;c<o;)(!g||!g.has(r[c]))&&r[c].remove(),c++;else if(r[c]===t[i-1]&&t[a]===r[o-1]){const v=r[--o].nextSibling;e.insertBefore(t[a++],r[c++].nextSibling),e.insertBefore(t[--i],v),r[o]=t[i]}else{if(!g){g=new Map;let m=a;for(;m<i;)g.set(t[m],m++)}const v=g.get(r[c]);if(v!=null)if(a<v&&v<i){let m=c,L=1,w;for(;++m<o&&m<i&&!((w=g.get(r[m]))==null||w!==v+L);)L++;if(L>v-a){const C=r[c];for(;a<v;)e.insertBefore(t[a++],C)}else e.replaceChild(t[a++],r[c++])}else c++;else r[c++].remove()}}}const be="_$DX_DELEGATE";function qe(e,r,t,n={}){let o;return Ue(i=>{o=i,r===document?e():x(r,e(),r.firstChild?null:void 0,t)},n.owner),()=>{o(),r.textContent=""}}function J(e,r,t){let n;const o=()=>{const c=document.createElement("template");return c.innerHTML=e,t?c.content.firstChild.firstChild:c.content.firstChild},i=r?()=>(n||(n=o())).cloneNode(!0):()=>fe(()=>document.importNode(n||(n=o()),!0));return i.cloneNode=i,i}function Ye(e,r=window.document){const t=r[be]||(r[be]=new Set);for(let n=0,o=e.length;n<o;n++){const i=e[n];t.has(i)||(t.add(i),r.addEventListener(i,He))}}function Fe(e,r,t,n){if(n)Array.isArray(t)?(e[`$$${r}`]=t[0],e[`$$${r}Data`]=t[1]):e[`$$${r}`]=t;else if(Array.isArray(t)){const o=t[0];e.addEventListener(r,t[0]=i=>o.call(e,t[1],i))}else e.addEventListener(r,t)}function x(e,r,t,n){if(t!==void 0&&!n&&(n=[]),typeof r!="function")return ae(e,r,n,t);ee(o=>ae(e,r(),o,t),n)}function He(e){const r=`$$${e.type}`;let t=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==t&&Object.defineProperty(e,"target",{configurable:!0,value:t}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}});t;){const n=t[r];if(n&&!t.disabled){const o=t[`${r}Data`];if(o!==void 0?n.call(t,o,e):n.call(t,e),e.cancelBubble)return}t=t._$host||t.parentNode||t.host}}function ae(e,r,t,n,o){for(;typeof t=="function";)t=t();if(r===t)return t;const i=typeof r,c=n!==void 0;if(e=c&&t[0]&&t[0].parentNode||e,i==="string"||i==="number")if(i==="number"&&(r=r.toString()),c){let a=t[0];a&&a.nodeType===3?a.data=r:a=document.createTextNode(r),t=V(e,t,n,a)}else t!==""&&typeof t=="string"?t=e.firstChild.data=r:t=e.textContent=r;else if(r==null||i==="boolean")t=V(e,t,n);else{if(i==="function")return ee(()=>{let a=r();for(;typeof a=="function";)a=a();t=ae(e,a,t,n)}),()=>t;if(Array.isArray(r)){const a=[],p=t&&Array.isArray(t);if(ye(a,r,t,o))return ee(()=>t=ae(e,a,t,n,!0)),()=>t;if(a.length===0){if(t=V(e,t,n),c)return t}else p?t.length===0?Ee(e,a,n):We(e,t,a):(t&&V(e),Ee(e,a));t=a}else if(r instanceof Node){if(Array.isArray(t)){if(c)return t=V(e,t,n,r);V(e,t,null,r)}else t==null||t===""||!e.firstChild?e.appendChild(r):e.replaceChild(r,e.firstChild);t=r}else console.warn("Unrecognized value. Skipped inserting",r)}return t}function ye(e,r,t,n){let o=!1;for(let i=0,c=r.length;i<c;i++){let a=r[i],p=t&&t[i];if(a instanceof Node)e.push(a);else if(!(a==null||a===!0||a===!1))if(Array.isArray(a))o=ye(e,a,p)||o;else if(typeof a=="function")if(n){for(;typeof a=="function";)a=a();o=ye(e,Array.isArray(a)?a:[a],Array.isArray(p)?p:[p])||o}else e.push(a),o=!0;else{const g=String(a);p&&p.nodeType===3?(p.data=g,e.push(p)):e.push(document.createTextNode(g))}}return o}function Ee(e,r,t=null){for(let n=0,o=r.length;n<o;n++)e.insertBefore(r[n],t)}function V(e,r,t,n){if(t===void 0)return e.textContent="";const o=n||document.createTextNode("");if(r.length){let i=!1;for(let c=r.length-1;c>=0;c--){const a=r[c];if(o!==a){const p=a.parentNode===e;!i&&!c?p?e.replaceChild(o,a):e.insertBefore(o,t):p&&a.remove()}else i=!0}}else e.insertBefore(o,t);return[o]}function Ve(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var t=function n(){if(this instanceof n){var o=[null];o.push.apply(o,arguments);var i=Function.bind.apply(r,o);return new i}return r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),t}var $e={},ze={get exports(){return $e},set exports(e){$e=e}};(function(e){var r=function(t){var n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(l,s,f){l[s]=f.value},c,a=typeof Symbol=="function"?Symbol:{},p=a.iterator||"@@iterator",g=a.asyncIterator||"@@asyncIterator",v=a.toStringTag||"@@toStringTag";function m(l,s,f){return Object.defineProperty(l,s,{value:f,enumerable:!0,configurable:!0,writable:!0}),l[s]}try{m({},"")}catch{m=function(s,f,h){return s[f]=h}}function L(l,s,f,h){var u=s&&s.prototype instanceof W?s:W,y=Object.create(u.prototype),P=new F(h||[]);return i(y,"_invoke",{value:de(l,f,P)}),y}t.wrap=L;function w(l,s,f){try{return{type:"normal",arg:l.call(s,f)}}catch(h){return{type:"throw",arg:h}}}var C="suspendedStart",K="suspendedYield",G="executing",I="completed",E={};function W(){}function q(){}function k(){}var Q={};m(Q,p,function(){return this});var X=Object.getPrototypeOf,Y=X&&X(X($([])));Y&&Y!==n&&o.call(Y,p)&&(Q=Y);var R=k.prototype=W.prototype=Object.create(Q);q.prototype=k,i(R,"constructor",{value:k,configurable:!0}),i(k,"constructor",{value:q,configurable:!0}),q.displayName=m(k,v,"GeneratorFunction");function re(l){["next","throw","return"].forEach(function(s){m(l,s,function(f){return this._invoke(s,f)})})}t.isGeneratorFunction=function(l){var s=typeof l=="function"&&l.constructor;return s?s===q||(s.displayName||s.name)==="GeneratorFunction":!1},t.mark=function(l){return Object.setPrototypeOf?Object.setPrototypeOf(l,k):(l.__proto__=k,m(l,v,"GeneratorFunction")),l.prototype=Object.create(R),l},t.awrap=function(l){return{__await:l}};function H(l,s){function f(y,P,j,T){var O=w(l[y],l,P);if(O.type==="throw")T(O.arg);else{var he=O.arg,Z=he.value;return Z&&typeof Z=="object"&&o.call(Z,"__await")?s.resolve(Z.__await).then(function(M){f("next",M,j,T)},function(M){f("throw",M,j,T)}):s.resolve(Z).then(function(M){he.value=M,j(he)},function(M){return f("throw",M,j,T)})}}var h;function u(y,P){function j(){return new s(function(T,O){f(y,P,T,O)})}return h=h?h.then(j,j):j()}i(this,"_invoke",{value:u})}re(H.prototype),m(H.prototype,g,function(){return this}),t.AsyncIterator=H,t.async=function(l,s,f,h,u){u===void 0&&(u=Promise);var y=new H(L(l,s,f,h),u);return t.isGeneratorFunction(s)?y:y.next().then(function(P){return P.done?P.value:y.next()})};function de(l,s,f){var h=C;return function(y,P){if(h===G)throw new Error("Generator is already running");if(h===I){if(y==="throw")throw P;return _()}for(f.method=y,f.arg=P;;){var j=f.delegate;if(j){var T=ne(j,f);if(T){if(T===E)continue;return T}}if(f.method==="next")f.sent=f._sent=f.arg;else if(f.method==="throw"){if(h===C)throw h=I,f.arg;f.dispatchException(f.arg)}else f.method==="return"&&f.abrupt("return",f.arg);h=G;var O=w(l,s,f);if(O.type==="normal"){if(h=f.done?I:K,O.arg===E)continue;return{value:O.arg,done:f.done}}else O.type==="throw"&&(h=I,f.method="throw",f.arg=O.arg)}}}function ne(l,s){var f=s.method,h=l.iterator[f];if(h===c)return s.delegate=null,f==="throw"&&l.iterator.return&&(s.method="return",s.arg=c,ne(l,s),s.method==="throw")||f!=="return"&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+f+"' method")),E;var u=w(h,l.iterator,s.arg);if(u.type==="throw")return s.method="throw",s.arg=u.arg,s.delegate=null,E;var y=u.arg;if(!y)return s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,E;if(y.done)s[l.resultName]=y.value,s.next=l.nextLoc,s.method!=="return"&&(s.method="next",s.arg=c);else return y;return s.delegate=null,E}re(R),m(R,v,"Generator"),m(R,p,function(){return this}),m(R,"toString",function(){return"[object Generator]"});function d(l){var s={tryLoc:l[0]};1 in l&&(s.catchLoc=l[1]),2 in l&&(s.finallyLoc=l[2],s.afterLoc=l[3]),this.tryEntries.push(s)}function b(l){var s=l.completion||{};s.type="normal",delete s.arg,l.completion=s}function F(l){this.tryEntries=[{tryLoc:"root"}],l.forEach(d,this),this.reset(!0)}t.keys=function(l){var s=Object(l),f=[];for(var h in s)f.push(h);return f.reverse(),function u(){for(;f.length;){var y=f.pop();if(y in s)return u.value=y,u.done=!1,u}return u.done=!0,u}};function $(l){if(l){var s=l[p];if(s)return s.call(l);if(typeof l.next=="function")return l;if(!isNaN(l.length)){var f=-1,h=function u(){for(;++f<l.length;)if(o.call(l,f))return u.value=l[f],u.done=!1,u;return u.value=c,u.done=!0,u};return h.next=h}}return{next:_}}t.values=$;function _(){return{value:c,done:!0}}return F.prototype={constructor:F,reset:function(l){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(b),!l)for(var s in this)s.charAt(0)==="t"&&o.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=c)},stop:function(){this.done=!0;var l=this.tryEntries[0],s=l.completion;if(s.type==="throw")throw s.arg;return this.rval},dispatchException:function(l){if(this.done)throw l;var s=this;function f(T,O){return y.type="throw",y.arg=l,s.next=T,O&&(s.method="next",s.arg=c),!!O}for(var h=this.tryEntries.length-1;h>=0;--h){var u=this.tryEntries[h],y=u.completion;if(u.tryLoc==="root")return f("end");if(u.tryLoc<=this.prev){var P=o.call(u,"catchLoc"),j=o.call(u,"finallyLoc");if(P&&j){if(this.prev<u.catchLoc)return f(u.catchLoc,!0);if(this.prev<u.finallyLoc)return f(u.finallyLoc)}else if(P){if(this.prev<u.catchLoc)return f(u.catchLoc,!0)}else if(j){if(this.prev<u.finallyLoc)return f(u.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(l,s){for(var f=this.tryEntries.length-1;f>=0;--f){var h=this.tryEntries[f];if(h.tryLoc<=this.prev&&o.call(h,"finallyLoc")&&this.prev<h.finallyLoc){var u=h;break}}u&&(l==="break"||l==="continue")&&u.tryLoc<=s&&s<=u.finallyLoc&&(u=null);var y=u?u.completion:{};return y.type=l,y.arg=s,u?(this.method="next",this.next=u.finallyLoc,E):this.complete(y)},complete:function(l,s){if(l.type==="throw")throw l.arg;return l.type==="break"||l.type==="continue"?this.next=l.arg:l.type==="return"?(this.rval=this.arg=l.arg,this.method="return",this.next="end"):l.type==="normal"&&s&&(this.next=s),E},finish:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var f=this.tryEntries[s];if(f.finallyLoc===l)return this.complete(f.completion,f.afterLoc),b(f),E}},catch:function(l){for(var s=this.tryEntries.length-1;s>=0;--s){var f=this.tryEntries[s];if(f.tryLoc===l){var h=f.completion;if(h.type==="throw"){var u=h.arg;b(f)}return u}}throw new Error("illegal catch attempt")},delegateYield:function(l,s,f){return this.delegate={iterator:$(l),resultName:s,nextLoc:f},this.method==="next"&&(this.arg=c),E}},t}(e.exports);try{regeneratorRuntime=r}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}})(ze);var Je={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}},Ke=(e,r)=>{const t=e._malloc(r.length*Uint32Array.BYTES_PER_ELEMENT);return r.forEach((n,o)=>{const i=e.lengthBytesUTF8(n)+1,c=e._malloc(i);e.stringToUTF8(n,c,i),e.setValue(t+Uint32Array.BYTES_PER_ELEMENT*o,c,"i32")}),[r.length,t]};const Qe="@ffmpeg/ffmpeg",Xe="0.11.6",Ze="FFmpeg WebAssembly version",et="src/index.js",tt="src/index.d.ts",rt={example:"examples"},nt={start:"node scripts/server.js","start:worker":"node scripts/worker-server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js","build:worker":"rimraf dist && webpack --config scripts/webpack.config.worker.prod.js",prepublishOnly:"npm run build",lint:"eslint src",wait:"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node node_modules/mocha/bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},ot={"./src/node/index.js":"./src/browser/index.js"},it={type:"git",url:"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},st=["ffmpeg","WebAssembly","video"],lt="Jerome Wu <jeromewus@gmail.com>",at="MIT",ct={url:"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},ft={node:">=12.16.1"},ut="https://github.com/ffmpegwasm/ffmpeg.wasm#readme",pt={"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},dt={"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.11.0","@types/emscripten":"^1.39.4","babel-eslint":"^10.1.0","babel-loader":"^8.1.0",chai:"^4.2.0",cors:"^2.8.5",eslint:"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1",express:"^4.17.1",mocha:"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0",webpack:"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"},ke={name:Qe,version:Xe,description:Ze,main:et,types:tt,directories:rt,scripts:nt,browser:ot,repository:it,keywords:st,author:lt,license:at,bugs:ct,engines:ft,homepage:ut,dependencies:pt,devDependencies:dt},ht=(typeof process<"u",`https://unpkg.com/@ffmpeg/core@${ke.devDependencies["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`),gt={corePath:ht};let we=!1,Re=()=>{};const mt=e=>{we=e},vt=e=>{Re=e},yt=(e,r)=>{Re({type:e,message:r}),we&&console.log(`[${e}] ${r}`)};var U={logging:we,setLogging:mt,setCustomLogger:vt,log:yt};const wt=e=>`
createFFmpegCore is not defined. ffmpeg.wasm is unable to find createFFmpegCore after loading ffmpeg-core.js from ${e}. Use another URL when calling createFFmpeg():

const ffmpeg = createFFmpeg({
  corePath: 'http://localhost:3000/ffmpeg-core.js',
});
`;var Se={CREATE_FFMPEG_CORE_IS_NOT_DEFINED:wt};const z=async(e,r)=>{U.log("info",`fetch ${e}`);const t=await(await fetch(e)).arrayBuffer();U.log("info",`${e} file size = ${t.byteLength} bytes`);const n=new Blob([t],{type:r}),o=URL.createObjectURL(n);return U.log("info",`${e} blob URL = ${o}`),o},bt=async({corePath:e,workerPath:r,wasmPath:t})=>{if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){if(typeof e!="string")throw Error("corePath should be a string!");const a=new URL(e,import.meta.url).href,p=await z(a,"application/javascript"),g=await z(t!==void 0?t:a.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),v=await z(r!==void 0?r:a.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise(m=>{if(globalThis.importScripts(p),typeof createFFmpegCore>"u")throw Error(Se.CREATE_FFMPEG_CORE_IS_NOT_DEFINED(a));U.log("info","ffmpeg-core.js script loaded"),m({createFFmpegCore,corePath:p,wasmPath:g,workerPath:v})}):(U.log("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:p,wasmPath:g,workerPath:v}))}if(typeof e!="string")throw Error("corePath should be a string!");const n=new URL(e,import.meta.url).href,o=await z(n,"application/javascript"),i=await z(t!==void 0?t:n.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),c=await z(r!==void 0?r:n.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise(a=>{const p=document.createElement("script"),g=()=>{if(p.removeEventListener("load",g),typeof createFFmpegCore>"u")throw Error(Se.CREATE_FFMPEG_CORE_IS_NOT_DEFINED(n));U.log("info","ffmpeg-core.js script loaded"),a({createFFmpegCore,corePath:o,wasmPath:i,workerPath:c})};p.src=o,p.type="text/javascript",p.addEventListener("load",g),document.getElementsByTagName("head")[0].appendChild(p)}):(U.log("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:o,wasmPath:i,workerPath:c}))},Ft=e=>new Promise((r,t)=>{const n=new FileReader;n.onload=()=>{r(n.result)},n.onerror=({target:{error:{code:o}}})=>{t(Error(`File could not be read! Code=${o}`))},n.readAsArrayBuffer(e)}),Et=async e=>{let r=e;return typeof e>"u"?new Uint8Array:(typeof e=="string"?/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?r=atob(e.split(",")[1]).split("").map(t=>t.charCodeAt(0)):r=await(await fetch(new URL(e,import.meta.url).href)).arrayBuffer():(e instanceof File||e instanceof Blob)&&(r=await Ft(e)),new Uint8Array(r))},$t=Object.freeze(Object.defineProperty({__proto__:null,defaultOptions:gt,fetchFile:Et,getCreateFFmpegCore:bt},Symbol.toStringTag,{value:"Module"})),xe=Ve($t),{defaultArgs:St,baseOptions:Lt}=Je,Ct=Ke,{defaultOptions:At,getCreateFFmpegCore:_t}=xe,{version:Pt}=ke,me=Error("ffmpeg.wasm is not ready, make sure you have completed load().");var jt=(e={})=>{const{log:r,logger:t,progress:n,...o}={...Lt,...At,...e};let i=null,c=null,a=null,p=null,g=!1,v=()=>{},m=r,L=n,w=0,C=0,K=!1,G=0;const I=d=>{d==="FFMPEG_END"&&a!==null&&(a(),a=null,p=null,g=!1)},E=(d,b)=>{v({type:d,message:b}),m&&console.log(`[${d}] ${b}`)},W=d=>{const[b,F,$]=d.split(":");return parseFloat(b)*60*60+parseFloat(F)*60+parseFloat($)},q=(d,b)=>{if(typeof d=="string")if(d.startsWith("  Duration")){const F=d.split(", ")[0].split(": ")[1],$=W(F);b({duration:$,ratio:G}),(w===0||w>$)&&(w=$,K=!0)}else if(K&&d.startsWith("    Stream")){const F=d.match(/([\d.]+) fps/);if(F){const $=parseFloat(F[1]);C=w*$}else C=0;K=!1}else if(d.startsWith("frame")||d.startsWith("size")){const F=d.split("time=")[1].split(" ")[0],$=W(F),_=d.match(/frame=\s*(\d+)/);if(C&&_){const l=parseFloat(_[1]);G=Math.min(l/C,1)}else G=$/w;b({ratio:G,time:$})}else d.startsWith("video:")&&(b({ratio:1}),w=0)},k=({type:d,message:b})=>{E(d,b),q(b,L),I(b)},Q=async()=>{if(E("info","load ffmpeg-core"),i===null){E("info","loading ffmpeg-core");const{createFFmpegCore:d,corePath:b,workerPath:F,wasmPath:$}=await _t(o);i=await d({mainScriptUrlOrBlob:b,printErr:_=>k({type:"fferr",message:_}),print:_=>k({type:"ffout",message:_}),locateFile:(_,l)=>{if(typeof window<"u"||typeof WorkerGlobalScope<"u"){if(typeof $<"u"&&_.endsWith("ffmpeg-core.wasm"))return $;if(typeof F<"u"&&_.endsWith("ffmpeg-core.worker.js"))return F}return l+_}}),c=i.cwrap(o.mainName||"proxy_main","number",["number","number"]),E("info","ffmpeg-core loaded")}else throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.")},X=()=>i!==null,Y=(...d)=>{if(E("info",`run ffmpeg command: ${d.join(" ")}`),i===null)throw me;if(g)throw Error("ffmpeg.wasm can only run one command at a time");return g=!0,new Promise((b,F)=>{const $=[...St,...d].filter(_=>_.length!==0);a=b,p=F,c(...Ct(i,$))})},R=(d,...b)=>{if(E("info",`run FS.${d} ${b.map(F=>typeof F=="string"?F:`<${F.length} bytes binary file>`).join(" ")}`),i===null)throw me;{let F=null;try{F=i.FS[d](...b)}catch{throw Error(d==="readdir"?`ffmpeg.FS('readdir', '${b[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:d==="readFile"?`ffmpeg.FS('readFile', '${b[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return F}},re=()=>{if(i===null)throw me;p&&p("ffmpeg has exited"),g=!1;try{i.exit(1)}catch(d){E(d.message),p&&p(d)}finally{i=null,c=null,a=null,p=null}},H=d=>{L=d},de=d=>{v=d},ne=d=>{m=d};return E("info",`use ffmpeg.wasm v${Pt}`),{setProgress:H,setLogger:de,setLogging:ne,load:Q,isLoaded:X,run:Y,exit:re,FS:R}};const Ot=jt,{fetchFile:Tt}=xe;var Le={createFFmpeg:Ot,fetchFile:Tt};const Nt=J('<div class="ConvertAudio"><div class="file-convert-button"><button></button></div><div class="preview"><div>Preview (right click to save audio)</div><audio id="track" controls>'),kt=J('<div class="file-progress"><div>'),Rt=J("<div>"),xt=e=>{const[r,t]=se(0),[n,o]=se(""),i=Le.createFFmpeg({log:!0}),c=async()=>{const p=e.mimeType,g=e.file;if(g){const{name:v}=g;t(.1),i.isLoaded()||await i.load(),i.setProgress(({ratio:w})=>{t(w)}),i.setLogger(({type:w,message:C})=>{o(`${w} - ${C}`)}),i.FS("writeFile",v,await Le.fetchFile(g)),await i.run("-i",v,`output.${p}`);const m=i.FS("readFile",`output.${p}`),L=document.getElementById("track");L.src=URL.createObjectURL(new Blob([m.buffer],{type:`audio/${p}`}))}},a=()=>r()*100;return(()=>{const p=Nt(),g=p.firstChild,v=g.firstChild,m=g.nextSibling;return v.$$click=c,x(v,()=>`Convert to ${e.mimeType}`),x(p,(()=>{const L=Be(()=>r()>0);return()=>L()&&[(()=>{const w=kt(),C=w.firstChild;return ee(()=>`${a()}%`!=null?C.style.setProperty("width",`${a()}%`):C.style.removeProperty("width")),w})(),(()=>{const w=Rt();return x(w,n),w})()]})(),m),ee(L=>{const w=!e.file,C=`${r()>=1?"block":"none"}`;return w!==L._v$&&(v.disabled=L._v$=w),C!==L._v$2&&((L._v$2=C)!=null?m.style.setProperty("display",C):m.style.removeProperty("display")),L},{_v$:void 0,_v$2:void 0}),p})()};Ye(["click"]);const Gt=J('<div class="ChooseFile"><div class="file-choose"><input type="file" id="file"><span></div><div class="file-convert-type"><div>Convert to<br><select>'),Mt=J("<option>"),Ut=e=>{const r=["mp4","mp3","wav"];return(()=>{const t=Gt(),n=t.firstChild,o=n.firstChild,i=n.nextSibling,c=i.firstChild,a=c.firstChild,p=a.nextSibling,g=p.nextSibling;return Fe(o,"change",e.selectFile),Fe(g,"change",e.updateSelectedMimeType),x(g,()=>r.map(v=>(()=>{const m=Mt();return m.value=v,x(m,v),m})())),t})()};const Bt=J('<div class="app"><div class="title"><h2>Simple audio converter</h2><p>Minimal audio converter app done client side. No uploading to a server required.</p><ol><li>Select an audio file to convert such as a .webm or .wav</li><li>Choose a format to convert to</li><li>Click on the convert button</li><li>Once completed, a preview of the audio file appears</li><li>Use this preview to download your audio file</ol><div class="credit">Audio conversion made possible by <a target="_blank" href="https://ffmpegwasm.netlify.app/">FFMPEG.WASM'),Dt=()=>{const[e,r]=se("mp4"),[t,n]=se(),o=c=>{c.stopPropagation(),c.preventDefault();const a=c.target.value;r(a)},i=c=>{c.stopPropagation(),c.preventDefault();const a=c.target.files[0];n(a)};return(()=>{const c=Bt();return c.firstChild,x(c,ve(Ut,{selectFile:i,updateSelectedMimeType:o}),null),x(c,ve(xt,{get mimeType(){return e()},get file(){return t()}}),null),c})()},It=document.getElementById("root");qe(()=>ve(Dt,{}),It);
